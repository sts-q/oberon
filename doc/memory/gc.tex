\section{Garbage Collection}

\subsection{Stack Collection}

The standard ETHZ Oberon system only allows garbage collection when
there are no open procedures containing variables on the stack.  This
is because the garbage collector does not scan the stack, and any
pointers present on the stack would be collected.

To be able to garbage collect procedures that are open on the stack,
two things are needed:

\begin{itemize}
\item Stack walking

  Given the current stack frame, it must be possible to properly
  decode each open stack frame up to the top of the stack.

  This capability is already present in Oberon in the \texttt{Trap}
  module.

\item Local variable decoding

  Once a stack frame has been decoded to a specific procedure, the
  contents of the procedure's stack frame must be decoded to know if
  there are any pointers.  This capability is also present in Oberon
  via the \emph{reference} information generated by the compiler and
  the \texttt{Trap} module.
\end{itemize}

The LMS Oberon system has repurposed the necessary code into
\texttt{ModuleInspector} and connected this to the garbage collector
via \texttt{Kernel.SetGCStackInfo}, and fully supports invoking the
garbage collector at any point.
